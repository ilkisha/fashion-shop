{% extends 'base.html.twig' %}

{% block title %}Products{% endblock %}

{% block body %}
    <h1>Products</h1>

    <div style="margin: 12px 0; display:flex; gap:10px; flex-wrap:wrap;">
        <a href="{{ path('catalog_index') }}"
           style="{{ gender is null ? 'font-weight:bold;' : '' }}">
            All
        </a>

        <a href="{{ path('catalog_index', {gender: 'men'}) }}"
           style="{{ gender == 'men' ? 'font-weight:bold;' : '' }}">
            Men
        </a>

        <a href="{{ path('catalog_index', {gender: 'women'}) }}"
           style="{{ gender == 'women' ? 'font-weight:bold;' : '' }}">
            Women
        </a>

        <a href="{{ path('catalog_index', {gender: 'unisex'}) }}"
           style="{{ gender == 'unisex' ? 'font-weight:bold;' : '' }}">
            Unisex
        </a>
    </div>

    <form method="get" action="{{ path('catalog_index') }}" style="margin: 12px 0;">
        {% if gender %}
            <input type="hidden" name="gender" value="{{ gender }}">
        {% endif %}

        <label for="category">Category:</label>
        <select id="category" name="category" onchange="this.form.submit()">
            <option value="">All categories</option>

            {% for c in categories %}
                <option value="{{ c }}" {{ c == category ? 'selected' : '' }}>
                    {{ c }}
                </option>
            {% endfor %}
        </select>
    </form>


    {% if products is empty %}
        <p>No products were found.</p>
    {% else %}
        <div style="display:grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap:16px;">
            {% for product in products %}
                <div style="border:1px solid #ddd; padding:12px; display:flex; flex-direction:column; gap:10px;">

                    {% if product.imagePath %}
                        <img
                            src="{{ asset('uploads/products/' ~ product.imagePath) }}"
                            alt="{{ product.name }}"
                            style="width:100%; height:180px; object-fit:cover;"
                        >
                    {% endif %}

                    <h3 style="margin:0;">
                        <a href="{{ path('catalog_show', {slug: product.slug}) }}">{{ product.name }}</a>
                    </h3>

                    <div style="opacity:0.9;">{{ product.category }} • {{ product.gender }}</div>
                    <div><strong>{{ product.price }} EUR</strong></div>

                    {# ✅ бутонът е вътре в card-а и “залепва” долу #}
                    <div style="margin-top:auto;">
                        <form method="post" action="{{ path('cart_add', {id: product.id}) }}">
                            <input type="hidden" name="qty" value="1">
                            <button type="submit" style="width:100%; padding:10px;">
                                Add to cart
                            </button>
                        </form>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% endif %}
{% endblock %}
